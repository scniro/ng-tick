Date.now=Date.now||function(){return+new Date},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(t){var i=Array.prototype.slice.call(arguments,1),e=this;return function(){return i.push.apply(i,arguments),e.apply(t,i)}}),function(t,i){"function"==typeof define&&define.amd?define(i):"object"==typeof exports?module.exports=i():t.Tock=i()}(this,function(){function t(){if(this.time+=this.interval,this.countdown&&this.duration_ms-this.time<0)return this.final_time=0,this.go=!1,this.callback(this),window.clearTimeout(this.timeout),void this.complete(this);this.callback(this);var i=Date.now()-this.start_time-this.time,e=i>0?this.interval-i:this.interval;0>=e?(this.missed_ticks=Math.floor(Math.abs(e)/this.interval),this.time+=this.missed_ticks*this.interval,this.go&&t.call(this)):this.go&&(this.timeout=window.setTimeout(t.bind(this),e))}function i(i){this.duration_ms=i,this.start_time=Date.now(),this.time=0,this.go=!0,t.call(this)}function e(i){this.start_time=i||Date.now(),this.time=0,this.go=!0,t.call(this)}var s=/^\s*(\+|-)?\d+\s*$/,n=/^(\d{1,2}):(\d{2})$/,o=/^(\d{1,2}):(\d{2})(?::|\.)(\d{2,3})$/,a=36e5,h=6e4,r=1e3,u=/^(\d{4})-([0-1]\d)-([0-3]\d)(?:\s|T)(\d{2}):(\d{2}):(\d{2})(?:\.(\d{3})Z?)?$/,l=function(t){return t=t||{},this instanceof l?(l.instances=(l.instances||0)+1,this.go=!1,this.timeout=null,this.missed_ticks=null,this.interval=t.interval||10,this.countdown=t.countdown||!1,this.start_time=0,this.pause_time=0,this.final_time=0,this.duration_ms=0,this.time=0,this.callback=t.callback||function(){},void(this.complete=t.complete||function(){})):new l(t)};return l.prototype.reset=function(){return this.countdown?!1:(this.stop(),this.start_time=0,void(this.time=0))},l.prototype.start=function(t){return this.go?!1:(t=t?this.timeToMS(t):0,this.start_time=t,this.pause_time=0,void(this.countdown?i.call(this,t):e.call(this,Date.now()-t)))},l.prototype.stop=function(){this.pause_time=this.lap(),this.go=!1,window.clearTimeout(this.timeout),this.countdown?this.final_time=this.duration_ms-this.time:this.final_time=Date.now()-this.start_time},l.prototype.pause=function(){this.go?(this.pause_time=this.lap(),this.stop()):this.pause_time&&(this.countdown?i.call(this,this.pause_time):e.call(this,Date.now()-this.pause_time),this.pause_time=0)},l.prototype.lap=function(){if(this.go){var t;return t=this.countdown?this.duration_ms-(Date.now()-this.start_time):Date.now()-this.start_time}return this.pause_time||this.final_time},l.prototype.msToTime=function(t){if(0>=t)return"00:00.000";var i=(t%r).toString(),e=Math.floor(t/r%60).toString(),s=Math.floor(t/h%60).toString();return 1===i.length?i="00"+i:2===i.length&&(i="0"+i),1===e.length&&(e="0"+e),1===s.length&&(s="0"+s),s+":"+e+"."+i},l.prototype.msToTimecode=function(t){if(0>=t)return"00:00:00";var i=Math.floor(t/r%60).toString(),e=Math.floor(t/h%60).toString(),s=Math.floor(t/a%60).toString();return 1===i.length&&(i="0"+i),1===e.length&&(e="0"+e),1===s.length&&(s="0"+s),s+":"+e+":"+i},l.prototype.timeToMS=function(t){if(s.test(String(t)))return t;var i,e,l,m,c=new Date;return n.test(t)?(e=t.split(":"),i=parseInt(e[0],10)*h,i+=parseInt(e[1],10)*r):(l=t.match(o),l?3==l[3].length||parseInt(l[3],10)>59?(i=parseInt(l[1],10)*h,i+=parseInt(l[2],10)*r,i+=parseInt(l[3],10)):(i=parseInt(l[1],10)*a,i+=parseInt(l[2],10)*h,i+=parseInt(l[3],10)*r):u.test(t)?(m=new Date,c=new Date,l=t.match(u),m.setYear(l[1]),m.setMonth(l[2]),m.setDate(l[3]),m.setHours(l[4]),m.setMinutes(l[5]),m.setSeconds(l[6]),"undefined"!=typeof l[7]&&m.setMilliseconds(l[7]),i=Math.max(0,m.getTime()-c.getTime())):(c=new Date,i=Date.parse(t),i=isNaN(i)?0:Math.max(0,i-c.getTime()))),i},l});