function init(){angular.module("ngTick",[]).directive("clock",["$filter","tick",function(n,t){return{scope:{format:"@",handle:"@clock",offset:"@",trigger:"="},link:function(o,e,i){o.handle&&(o.$root[o.handle]=o);var r=n("date"),a=t.clock({interval:100,offset:o.offset,onStart:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":start",n)},onTick:function(n){var t=o.format?r(new Date(n),o.format):new Date(n);void 0!==e[0].value?e.val(t):e.text(t)}});o.start=function(){a.start()},o.$on("$destroy",function(){a.stop()}),o.trigger||o.start()}}}]).directive("timer",["$filter","tick",function(n,t){return{scope:{format:"@",handle:"@timer",trigger:"="},link:function(o,e,i){var r={date:n("date"),relative:n("relativeTime")};o.handle&&(o.$root[o.handle]=o);var a=t.timer({onLap:function(n,t,e){o.handle&&o.$root[o.handle].$emit(o.handle+":lap",{lap:n,elapsed:t},e)},onReset:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":reset",n)},onStart:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":start",n)},onStop:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":stop",n)},onTick:function(n){var t=r.relative(n),i=o.format?r.date(t,o.format):t;void 0!==e[0].value?e.val(i):e.text(i)}});o.lap=function(){a.lap()},o.reset=function(){a.reset()},o.start=function(){a.start()},o.stop=function(){a.stop()},o.$on("$destroy",function(){a.stop()}),o.trigger||o.start()}}}]).directive("countdown",["$filter","tick",function(n,t){return{scope:{duration:"=",format:"@",handle:"@countdown",interval:"=",trigger:"="},link:function(o,e,i){var r={date:n("date"),relative:n("relativeTime")};o.handle&&(o.$root[o.handle]=o);var a=t.countdown({onEnd:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":end",n)},onReset:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":reset",n)},onStart:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":start",n)},onStop:function(n){o.handle&&o.$root[o.handle].$emit(o.handle+":stop",n)},onTick:function(n){var t=r.relative(n),i=o.format?r.date(t,o.format):t;void 0!==e[0].value?e.val(i):e.text(i)}});o.reset=function(){a.reset(o.duration)},o.start=function(){a.start(o.duration)},o.stop=function(){a.stop()},o.$on("$destroy",function(){a.stop()}),o.trigger||o.start()}}}]).filter("relativeTime",[function(){return function(n){return new Date(1970,0,1,0).setMilliseconds(n)}}]).factory("tick",["engine",function(n){function t(t){function o(){i.status().running||(i.start(t.interval),a.onStart(i.status()))}function e(){i.status().running&&i.stop()}t=t||{};var i=new n,r=t.offset?60*(parseInt(t.offset)/100*60+(new Date).getTimezoneOffset())*1e3:0,a=this;return i.on(function(n){var t=Date.now()+r;a.onTick(t)}),a.onStart=t.onStart||function(){},a.onTick=t.onTick||function(){},{start:o,stop:e}}function o(t){function o(n){var t=new Date;return t.setMilliseconds(t.getMilliseconds()+(n.ms?n.ms:0)),t.setSeconds(t.getSeconds()+(n.s||0)),t.setMinutes(t.getMinutes()+(n.m||0)),t.setHours(t.getHours()+(n.h||0)),Math.abs(t-new Date)}function e(){s.status().running&&(s.stop(),c.onEnd(s.status()))}function i(n){u=o(n)||0,c.onTick(u),s.stop(),c.onReset(s.status())}function r(n){s.status().running||(u=u>0?u:o(n)||0,s.start(t.interval),c.onStart(s.status()))}function a(){s.status().running&&(s.stop(),c.onStop(s.status()))}t=t||{};var u,s=new n,c=this;return s.on(function(n){u-=n,u>=0?c.onTick(u):e()}),c.onEnd=t.onEnd||function(){},c.onReset=t.onReset||function(){},c.onStart=t.onStart||function(){},c.onStop=t.onStop||function(){},c.onTick=t.onTick||function(){},{reset:i,start:r,stop:a}}function e(t){function o(){s.status().running&&(o=!0,u+=1,f.onLap(u,c,s.status()),c=0)}function e(){a=0,f.onTick(a),s.stop(),f.onReset(s.status())}function i(){s.status().running||(a=a>0?a:0,s.start(t.interval),f.onStart(s.status()))}function r(){s.status().running&&(s.stop(),f.onStop(s.status()))}t=t||{};var a,u=0,s=new n,c=0,f=this;return s.on(function(n){a+=n,c+=n,f.onTick(a)}),f.onLap=t.onLap||function(){},f.onReset=t.onReset||function(){},f.onStart=t.onStart||function(){},f.onStop=t.onStop||function(){},f.onTick=t.onTick||function(){},{lap:o,reset:e,start:i,stop:r}}return{clock:function(n){return new t(n)},countdown:function(n){return new o(n)},timer:function(n){return new e(n)}}}]).factory("engine",function(){var n=function(){function n(n){c.on=n||function(){}}function t(n){return a=n||10,r=Date.now(),s=0,c.running=!0,u=setTimeout(i,a),this}function o(){return{running:c.running,timeoutThread:u}}function e(){clearTimeout(u),c.running=!1}function i(){if(c.running){s+=a,c.on&&c.on(a);var n=Date.now()-r-s;setTimeout(i,a-n)}}var r,a,u,s,c=this;return c.running=!1,{on:n,start:t,status:o,stop:e}};return n})}!function(){"function"==typeof define&&define.amd?define(["angular"],function(){init()}):init()}();